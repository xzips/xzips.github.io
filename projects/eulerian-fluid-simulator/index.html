<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Eulerian Fluid Simulator | Aspen Erlandsson</title><link rel="icon" type="image/svg+xml" href="/favicon.svg"><link rel="stylesheet" href="/_astro/_slug_.CCerpc1y.css">
<link rel="stylesheet" href="/_astro/_slug_.I2aT2Z64.css">
<style>.page{color:#e2e8f0eb;background:#020617}.container{width:100%;max-width:68rem;margin:0 auto;padding:0 0 4rem}@media(min-width:640px){.container{padding:0 1rem 4rem}}.hero-crop{position:relative;width:100%;aspect-ratio:5 / 1;max-height:400px;min-height:260px;overflow:hidden;border-radius:1.25rem;border:1px solid rgba(255,255,255,.1);background:#02061799;box-shadow:inset 0 0 0 1px #ffffff0a;margin-top:.75rem}.hero-crop video{width:100%;height:100%;object-fit:cover;display:block}.hero-overlay{position:absolute;inset:0;background:linear-gradient(to bottom,#02061740,#020617d9)}.hero-title{position:absolute;inset:0;display:flex;align-items:flex-end;justify-content:center;padding:1rem;text-align:center}.hero-title h1{margin:0;color:#f8fafcfa;font-weight:800;letter-spacing:-.02em;font-size:clamp(1.4rem,2.6vw,2.1rem)}.summary{margin-top:1rem;display:grid;gap:.75rem}@media(min-width:768px){.summary{grid-template-columns:1fr 1fr}.summary .stack{grid-column:1 / -1}}.card{border-radius:1rem;border:1px solid rgba(255,255,255,.1);background:#020617a6;padding:1rem}.kicker{margin:0;font-size:.8rem;font-weight:700;text-transform:uppercase;letter-spacing:.18em;color:#e2e8f0f2}.bullets{margin:.75rem 0 0;padding:0;list-style:none;display:grid;gap:.5rem;font-size:.95rem;color:#e2e8f0e6}.bullet-row{display:flex;gap:.6rem;align-items:flex-start}.dot{margin-top:.45rem;height:.5rem;width:.5rem;border-radius:9999px;background:#94a3b8e6;flex:0 0 auto}.chips{margin-top:.75rem;display:flex;flex-wrap:wrap;gap:.5rem}.chip{border-radius:9999px;border:1px solid rgba(255,255,255,.12);background:#ffffff14;padding:.35rem .75rem;font-size:12px;font-weight:700;color:#f8fafcfa}.writeup-wrap{margin-top:1.25rem;border-radius:1rem;border:1px solid rgba(255,255,255,.1);background:#0206178c;padding:1.25rem}.writeup h2{margin:2rem 0 1rem;color:#f8fafcfa;font-weight:800;letter-spacing:-.02em;font-size:1.6rem;line-height:1.15}.writeup h3{margin:1.5rem 0 .75rem;color:#f8fafcfa;font-weight:800;letter-spacing:-.01em;font-size:1.15rem}.writeup p{margin:0 0 1rem;line-height:1.7}.writeup li{line-height:1.65}.writeup ul,.writeup ol{margin:.5rem 0 1.25rem 1.25rem;padding-left:1.25rem}.writeup ul{list-style:disc}.writeup ol{list-style:decimal}.writeup ul ul,.writeup ol ol,.writeup ul ol,.writeup ol ul{margin-top:.4rem}.writeup li{margin:.35rem 0}.writeup a{color:#7dd3fcf2;text-decoration:none}.writeup a:hover{text-decoration:underline}.writeup img,.writeup video{border-radius:.75rem;border:1px solid rgba(255,255,255,.12);background:#02061799}.writeup .media,.writeup .media-video,.writeup table,.writeup .math-block{margin:1.25rem 0}.media-video{width:100%;border-radius:1rem;border:1px solid rgba(255,255,255,.1);display:block}.media{margin-top:.75rem;width:100%;max-width:760px;display:block}.placeholder{margin:.75rem 0 0;opacity:.92}.writeup img,.prose img,.img-box{transition:transform .18s ease,box-shadow .18s ease,border-color .18s ease;cursor:pointer}.writeup img:hover,.prose img:hover,.img-box:hover{transform:translateY(-2px) scale(1.01);box-shadow:0 8px 20px #00000059}.lightbox{position:fixed;top:0;left:0;width:100%;height:100%;z-index:2147483647;background:#020617f5;backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s ease;padding:2rem}.lightbox.active{opacity:1;pointer-events:auto}.lightbox-content{position:relative;max-width:100%;max-height:100%;display:flex;align-items:center;justify-content:center}.lightbox-img{max-width:95vw;max-height:95vh;object-fit:contain;border-radius:4px;box-shadow:0 0 60px #000000e6;border:1px solid rgba(255,255,255,.1)}.lightbox-close{position:absolute;top:2rem;right:2rem;background:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.1);width:3.5rem;height:3.5rem;border-radius:50%;font-size:2rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;z-index:100000}.lightbox-close:hover{background:#ffffff4d;transform:scale(1.05)}
</style></head> <body class="bg-slate-950 text-slate-100 antialiased"> <div class="pointer-events-none fixed inset-0 -z-10 opacity-40"> <div class="absolute inset-0 bg-[radial-gradient(circle_at_20%_20%,rgba(56,189,248,0.18),transparent_25%)]"></div> <div class="absolute inset-0 bg-[radial-gradient(circle_at_80%_0%,rgba(129,140,248,0.12),transparent_22%)]"></div> <div class="absolute inset-0 bg-[radial-gradient(circle_at_10%_80%,rgba(52,211,153,0.12),transparent_30%)]"></div> </div> <main class="mx-auto flex max-w-6xl flex-col gap-6 px-4 pb-16 pt-10 sm:px-6 lg:px-8"> <div class="flex items-center justify-between gap-3"> <a class="inline-flex items-center gap-2 text-sm font-semibold text-sky-200 transition hover:text-sky-100" href="/#projects"> <span aria-hidden="true">←</span> Back to projects
</a> </div> <section class="relative overflow-hidden rounded-3xl border border-white/8 bg-slate-950/90 p-6 shadow-2xl backdrop-blur sm:p-10"> <div class="absolute inset-0 bg-gradient-to-br from-cyan-300/55 via-emerald-300/50 to-lime-300/50 opacity-20"></div> <div class="relative space-y-8">  <div class="flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between"> <div class="space-y-2"> <h1 class="text-2xl font-bold text-slate-50 sm:text-3xl">Eulerian Fluid Simulator</h1> <p class="max-w-3xl text-sm leading-relaxed text-slate-300/90">Real-time 2D incompressible fluid solver on Android/PC. Uses OpenMP and Gauss-Seidel relaxation for high-performance CFD.</p> </div> <div class="flex flex-wrap gap-2 sm:justify-end"> <span class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-slate-200"> Parallel C++ / Numerics </span> <span class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-slate-400"> Realtime mobile </span><span class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-slate-400"> Multicore CFD </span><span class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-semibold text-slate-400"> 3k lines C++ </span> </div> </div> <div class="h-px w-full bg-white/5"></div> <div class="prose prose-invert max-w-none prose-headings:text-slate-100 prose-p:text-slate-300 prose-a:text-sky-300 hover:prose-a:text-sky-200 prose-strong:text-slate-50 prose-code:text-sky-200 prose-pre:bg-slate-950/50 prose-pre:border prose-pre:border-white/10"> <script type="module" src="/_astro/eulerian-fluid-simulator.astro_astro_type_script_index_0_lang.2DUTERfN.js"></script> <section class="page" data-astro-cid-wdripdv5> <div class="container" data-astro-cid-wdripdv5> <!-- Thin hero slice: background video + title (no extra project image) --> <section class="hero-crop" aria-label="Project hero" data-astro-cid-wdripdv5> <video autoplay muted loop playsinline data-astro-cid-wdripdv5> <source src="/_astro/Fluid%20Sim%20Background%20Clip%20V2.CZf-Yh0U.mp4" type="video/mp4" data-astro-cid-wdripdv5>
Your browser does not support the video tag.
</video> <div class="hero-overlay" data-astro-cid-wdripdv5></div> <div class="hero-title" data-astro-cid-wdripdv5> <h1 class="mb-3 bread" data-astro-cid-wdripdv5>Realtime Fluid Simulation</h1> </div> </section> <!-- Technical focus + Results + Stack first --> <section class="summary" data-astro-cid-wdripdv5> <div class="card" data-astro-cid-wdripdv5> <h4 class="kicker" data-astro-cid-wdripdv5>Technical focus</h4> <ul class="bullets" data-astro-cid-wdripdv5> <li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>2D incompressible solver using 50-200 Gauss-Seidel iterations per frame, with a red-black variant for parallelism.</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>OpenMP multi-core across simulation steps, tested on a 12-core 3.8GHz Ryzen.</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>Raw buffer rendering techniques dropped a runtime hotspot from 25ms to 0.36ms while keeping the UI interactive.</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>Cross-platform pure C++ build with interactive visualization modes.</span> </li> </ul> </div> <div class="card" data-astro-cid-wdripdv5> <h4 class="kicker" data-astro-cid-wdripdv5>Results</h4> <ul class="bullets" data-astro-cid-wdripdv5> <li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>Runs ~60 fps at 269x152 with 100 Gauss-Seidel iterations on a 12-core 3.8GHz Ryzen.</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>OpenMP and red-black GS delivered ~10x speedup (451ms -&gt; 44.5ms) for the pressure solve.</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>Rendering optimizations improved draw time by ~70x (25ms -&gt; 0.36ms).</span> </li><li class="bullet-row" data-astro-cid-wdripdv5> <span class="dot" data-astro-cid-wdripdv5></span> <span data-astro-cid-wdripdv5>Cross-platform source runs on Windows, macOS, Linux, and tested on mobile/Android.</span> </li> </ul> </div> <div class="card stack" data-astro-cid-wdripdv5> <h4 class="kicker" data-astro-cid-wdripdv5>Stack</h4> <div class="chips" data-astro-cid-wdripdv5> <span class="chip" data-astro-cid-wdripdv5>vector calculus</span><span class="chip" data-astro-cid-wdripdv5>c++</span><span class="chip" data-astro-cid-wdripdv5>computational fluid dynamics (CFD)</span><span class="chip" data-astro-cid-wdripdv5>multiprocessing</span><span class="chip" data-astro-cid-wdripdv5>simulation</span><span class="chip" data-astro-cid-wdripdv5>user interface</span><span class="chip" data-astro-cid-wdripdv5>optimization</span> </div> </div> </section> <!-- Full writeup (verbatim content) --> <section class="writeup-wrap" data-astro-cid-wdripdv5> <div class="writeup" data-astro-cid-wdripdv5> <h2 class="mb-3" data-astro-cid-wdripdv5>How I Created a Cross-Platform Multithreaded Eulerian Fluid Simulator Using Pure C++</h2> <a href="https://github.com/xzips/Euler-Fluid-Simulation" target="_blank" class="btn btn-outline-primary" data-astro-cid-wdripdv5>
Available on GitHub
</a> <h3 data-astro-cid-wdripdv5>Introduction </h3> <p data-astro-cid-wdripdv5>
As an Aerospace Engineering student, I've built a solid foundation in fluid mechanics and vector calculus through several courses.
          In this project I applied the principles I've learned to build an Eulerian fluid simulator.
          The governing equations of fluid flow, known as the Navier-Stokes equations, provide a detailed description of the motion of fluid substances.
</p> <p data-astro-cid-wdripdv5>
These equations account for the conservation of momentum, mass, and energy in a fluid, which is the basis for modern computational fluid dynamics (CFD) analysis.
          This simulator is a direct implementation of those principles, allowing me to explore interactively how fluids behave under different conditions, and gain a better intuition for the equations themselves.
</p> <h3 data-astro-cid-wdripdv5>Demo </h3>
The current version of my fluid simulator is a 2D simulation that runs in real-time on any modern computer.
        The simulation is interactive, allowing the user to drag objects around, and change the visualization mode between:
<ul data-astro-cid-wdripdv5> <li data-astro-cid-wdripdv5>Dye field</li> <li data-astro-cid-wdripdv5>Pressure field</li> <li data-astro-cid-wdripdv5>Velocity direction</li> <li data-astro-cid-wdripdv5>Vorticity field</li> </ul> <video width="100%" controls data-astro-cid-wdripdv5> <source src="/_astro/Fluid%20Sim%20Demo.iHXf4GJr.mp4" type="video/mp4" data-astro-cid-wdripdv5>
Your browser does not support the video tag.
</video>
The simulation is also highly optimized, running in realtime(~60fps average) on my 12-core 3.8GHz Ryzen system with a grid size of 269x152, and using 100 Gauss-Seidel iterations per frame.
        The simulation is also cross-platform, running on Windows, MacOS, Linux, etc.
        However, note that I only provide a pre-compiled executable for Windows on the GitHub since that's the most common platform.
<h3 data-astro-cid-wdripdv5>Math </h3> <p data-astro-cid-wdripdv5>
Without getting too deep into the math, I'd like to give you an idea of the Navier-Stokes equations:
</p> <p data-astro-cid-wdripdv5>
\[
\frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} = -\frac{1}{\rho} \nabla p + \nu \nabla^2 \mathbf{u} + \mathbf{f}
\]
\[
\nabla \cdot \mathbf{u} = 0
\]
</p> <p data-astro-cid-wdripdv5>
Looks scary - and is scary. Solving these equations in general has not been done yet, and solving them in a discrete case is still very hard, so we will make some assumptions:
</p> <ul data-astro-cid-wdripdv5> <li data-astro-cid-wdripdv5><b data-astro-cid-wdripdv5>Inviscid Flow:</b> The Euler equations assume that the fluid has no viscosity. This means that internal friction between fluid layers (which arises from viscosity) is neglected. As a result, the Euler equations do not account for shear stresses within the fluid.</li> <li data-astro-cid-wdripdv5><b data-astro-cid-wdripdv5>No Heat Conduction:</b> The Euler equations also assume there is no heat conduction within the fluid, i.e. no energy transfer due to temperature gradients.</li> </ul> <p data-astro-cid-wdripdv5>
Putting it all together, we obtain the Euler equations:
</p> <p data-astro-cid-wdripdv5>
\[
\frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} = -\frac{1}{\rho} \nabla p + \mathbf{f}
\]
\[
\nabla \cdot \mathbf{u} = 0
\]
</p> <h3 data-astro-cid-wdripdv5>Implementation </h3> <p data-astro-cid-wdripdv5>
While the Euler equations are nice to look at, we can't use them directly to compute the solution, so to do that we will discretize them into a simulation loop following this strategy:
</p> <ul data-astro-cid-wdripdv5> <li data-astro-cid-wdripdv5>Add or modify boundary conditions, i.e. dragging the model, setting inlet velocity, adding dye to see streamlines, etc.</li> <li data-astro-cid-wdripdv5>Solve the incompressibility condition (constant density everywhere) using 50-200 iterations of the Gauss-Seidel method over the entire simulation grid. This step takes around 90% of the compute time, and hence much time was spent optimizing it.</li> <li data-astro-cid-wdripdv5>Solve boundary conditions at edges of the simulation and for the body in the flow.</li> <li data-astro-cid-wdripdv5>Advect velocity from each cell to the next in the appropriate directions.</li> <li data-astro-cid-wdripdv5>Advect dye (visualization).</li> <li data-astro-cid-wdripdv5>Render results, handle user interface, etc.</li> </ul> <h3 data-astro-cid-wdripdv5>Optimizations </h3> <p data-astro-cid-wdripdv5>
Fluid simulations are computationally expensive, and optimization was always a goal for this project. Currently, the following techniques are implemented:
</p> <ul data-astro-cid-wdripdv5> <li data-astro-cid-wdripdv5>Writing everything in C++ and compiling with maximum auto-optimization offers good baseline performance.</li> <li data-astro-cid-wdripdv5>OpenMP is used for multi-core processing of all simulation aspects, greatly accelerating solve time. Benchmarks showed that the difference between OpenMP on/off on my 12-core Ryzen 3.8GHz system was on the order of ~10x performance gain (451ms solve time to 44.5ms solve time).</li> <li data-astro-cid-wdripdv5>Using a slight variation on the traditional method, the Gauss-Seidel Red-Black approach to solving the incompressibility condition allows for parallelizing an otherwise purely sequential problem, which contributed to the 10x performance gain quoted above.</li> <li data-astro-cid-wdripdv5>Rendering functions operate on raw pixel and data arrays as much as possible, and only use expensive draw and display buffer operations at the very end of rendering where it's necessary. This improved frame render time from 25ms to 0.36ms (70x improvement) compared to the original function.</li> </ul> <h3 data-astro-cid-wdripdv5>Analysis of Results</h3> <p data-astro-cid-wdripdv5>The simulation produces a number of correct phenomena, such as:</p> <ul style="list-style: none; padding-left: 0;" data-astro-cid-wdripdv5> <li style="margin-bottom: 20px;" data-astro-cid-wdripdv5> <b data-astro-cid-wdripdv5>Pressure Distribution on an Angled Airfoil:</b> As expected in fluid dynamics, the pressure on the top surface of the airfoil is lower (blue), and the pressure on the bottom surface is higher (orange), generating lift. You can read more about airfoil pressure distribution on the <a href="https://en.wikipedia.org/wiki/Airfoil" target="_blank" data-astro-cid-wdripdv5>Wikipedia page</a>.
<br data-astro-cid-wdripdv5> <img src="/_astro/AirfoilPressureGradient.9fnPxO_x.PNG" alt="Pressure Distribution on Airfoil Screenshot" style="width: 100%; max-width: 600px; margin-top: 10px;" data-astro-cid-wdripdv5> </li> <li style="margin-bottom: 20px;" data-astro-cid-wdripdv5> <b data-astro-cid-wdripdv5>Vortex Shedding:</b> The simulation shows clear vortex shedding behind obstacles in the flow, a phenomenon where alternating vortices are shed from either side of an object, such as a cylinder cross-section, as seen below. You can read more about vortex shedding on the <a href="https://en.wikipedia.org/wiki/Vortex_shedding" target="_blank" data-astro-cid-wdripdv5>Wikipedia page</a>.
<br data-astro-cid-wdripdv5> <img src="/_astro/VortexSheddingCube.D-oFCjBL.PNG" alt="Vortex Shedding Screenshot" style="width: 100%; max-width: 600px; margin-top: 10px;" data-astro-cid-wdripdv5> </li> <li data-astro-cid-wdripdv5> <b data-astro-cid-wdripdv5>Flow Stability:</b> Despite the sharp changes in flow direction (velocity gradient) and the presence of obstacles, the simulation remains stable under the test conditions, indicating a well-functioning solver.
            Stability is maintained even in regions with high velocity gradients due to boundaries, as seen below where the velocity
            source and airfoil boundary are placed in close proximity.
<br data-astro-cid-wdripdv5> <video width="100%" max-width="600px" controls style="margin-top: 10px;" data-astro-cid-wdripdv5> <source src="/_astro/StabilityDemo1.BgvC4A5K.mp4" type="video/mp4" data-astro-cid-wdripdv5>
Your browser does not support the video tag.
</video> </li> </ul> </div> </section> </div> </section> </div> </div> </section> </main> <script type="module">(()=>{const b=()=>{let t=document.getElementById("lightbox");if(!t)t=document.createElement("div"),t.id="lightbox",t.className="lightbox",t.innerHTML=`
          <button id="lightbox-close" class="lightbox-close" type="button" aria-label="Close image">&times;</button>
          <div class="lightbox-content">
            <img id="lightbox-img" class="lightbox-img" src="" alt="Full view" />
          </div>
        `,document.body.appendChild(t);else{if(t.classList.add("lightbox"),t.parentElement!==document.body&&document.body.appendChild(t),!t.querySelector("#lightbox-img")){const i=document.createElement("img");i.id="lightbox-img",i.className="lightbox-img",i.alt="Full view",t.appendChild(i)}if(!t.querySelector("#lightbox-close")){const i=document.createElement("button");i.id="lightbox-close",i.className="lightbox-close",i.type="button",i.setAttribute("aria-label","Close image"),i.textContent="×",t.prepend(i)}}const r=t.querySelector("#lightbox-img"),o=t.querySelector("#lightbox-close");return t.setAttribute("aria-hidden","true"),{lightbox:t,lightboxImg:r,closeBtn:o}},d=t=>{if(!t||t.getAttribute("data-lightbox")==="false")return null;const r=t.getAttribute("data-src");if(r)return{src:r,alt:t.getAttribute("data-alt")||""};const o=t.tagName==="IMG"?t:t.querySelector("img");if(!o)return null;const i=o.currentSrc||o.getAttribute("src");return i?{src:i,alt:o.getAttribute("alt")||""}:null},u=()=>{const{lightbox:t,lightboxImg:r,closeBtn:o}=b();if(!t||!r)return;const i=(e,s)=>{r.src=e,r.alt=s||"Full view",t.classList.add("active"),t.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden"},c=()=>{t.classList.remove("active"),t.setAttribute("aria-hidden","true"),document.body.style.overflow="",setTimeout(()=>{r.src=""},200)};t.dataset.handlersAttached||(o?.addEventListener("click",c),t.addEventListener("click",e=>{e.target===t&&c()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&t.classList.contains("active")&&c()}),t.dataset.handlersAttached="true");const g=e=>{!e||e.dataset.lightboxBound==="true"||e.closest(".lightbox")||e.matches("video")||e.querySelector("video")||e.matches("img")&&e.closest(".img-box")||e.getAttribute("data-lightbox")==="false"||!d(e)||(e.dataset.lightboxBound="true",e.addEventListener("click",()=>{const l=d(e);l&&i(l.src,l.alt)}))},n=(e=document)=>{Array.from(e.querySelectorAll(".prose img, .writeup img, .img-box")).forEach(g)};if(n(),window.__writeupLightboxObserver)n();else{const e=new MutationObserver(s=>{s.forEach(l=>{l.addedNodes.forEach(a=>{a instanceof HTMLElement&&(a.matches(".prose img, .writeup img, .img-box")&&g(a),a.querySelectorAll&&n(a))})})});e.observe(document.body,{childList:!0,subtree:!0}),window.__writeupLightboxObserver=e}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",u):u()})();</script> </body></html>